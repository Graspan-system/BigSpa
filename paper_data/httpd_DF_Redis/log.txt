
[experiment@slave001 Graspan]$ spark-submit \
> --master yarn \
> --deploy-mode client \
> --name JiangXi_httpd_df_Redis \
> --class Bigspa_df_getdatacode \
> --num-executors 16 \
> --executor-cores 24 \
> --executor-memory 15G \
> --driver-memory 16G \
> --conf spark.storage.unrollMemoryThreshold=10000000 \
> --conf spark.locality.wait.time=1ms \
> --files pasa.conf.prop \
> --driver-class-path /home/experiment/jiangxi/res/ \
>  \
> Graspan_noBF-1.0-SNAPSHOT-jar-with-dependencies.jar \
>  \
> islocal,false \
> master,hdfs://slave001:9001/ \
> input_grammar,/jiangxi/Graspan/data/GrammarFiles/rules_dataflow \
> input_e,/jiangxi/Graspan/data/InputGraph/httpd_dataflow_e/part-00000 \
> input_n,/jiangxi/Graspan/data/InputGraph/httpd_dataflow_n/part-00000 \
> isSingleton,true \
>  \
> output,/jiangxi/Graspan/result/httpd_df_Redis \
> checkpoint_output,hdfs://slave001:9001/jiangxi/Graspan/checkpoint_hardcode \
> hbase_output,/jiangxi/Graspan/result/pt/hbhfile_hardcode \
>  \
> updateRedis_interval,500000 \
> queryRedis_interval,50000 \
>  \
> is_complete_loop,true \
> max_complete_loop_turn,5 \
> max_convergence_loop,100 \
>  \
> defaultpar,384 \
> clusterpar,384 \
> newnum_interval,40000000 \
> checkpoint_interval,5 \
>  \
> file_index_f,0 \
> file_index_b,12 \
>  \
> check_edge,false \
> convergence_threshold,10000 \
> output_Par_INFO,false
log4j:WARN No such property [append] in org.apache.log4j.ConsoleAppender.

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@      Graspan Begin at 2018-04-18 21:12:49    @@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

18/04/18 21:12:49.964 main WARN NativeCodeLoader: Unable to load native-hadoop library for your atform... using builtin-java classes where applicable
18/04/18 21:12:50.060 main WARN SparkConf: In Spark 1.0 and later spark.local.dir will be overrien by the value set by the cluster manager (via SPARK_LOCAL_DIRS in mesos/standalone and LOCAL_DS in YARN).
------------Spark and HBase settings--------------------------------
spark.driver.memory:            16G
spark.executor.memory:          15G
spark.executor.cores:           24
default partition num:          384
cluster partition num:          384
queryRedis_interval:            50000
updateRedis_interval:           500000
--------------------------------------------------------------------

e counts : 9905624
n counts : 138331
------------Graph INFO--------------------------------------------
input graph:            /jiangxi/Graspan/data/InputGraph/httpd_dataflow_e/part-00000
processed e:            9905624
processed n:            138331
nodes_totoalnum:        5744229
nodes_num_bitsize:      7
max_loop_turn:          5
convergence_turn:       100
------------------------------------------------------------------

Load configuration done!
Origin Update Redis take time:          4.642sec
Init e in 0Partitions

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@      Compute Begin AT 2018-04-18 21:14:18    @@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

Please confirm to start compute!
1

************During step 1************
18/04/18 21:15:01.978 task-result-getter-2 WARN TaskSetManager: Lost task 171.0 in stage 13.0 (TID 5529, slave011, executor 11): java.lang.NullPointerException
        at cn.edu.nju.pasalab.db.ShardedRedisClusterClient.getAll(ShardedRedisClusterClient.java:80)
        at utils.Redis_OP$.queryRedis_compressed_df(Redis_OP.scala:116)
        at utils.Graspan_OP$.computeInPartition_df_compressnew_Redis(Graspan_OP.scala:316)
        at Bigspa_df_getdatacode$$anonfun$8.apply(Bigspa_df_getdatacode.scala:220)
        at Bigspa_df_getdatacode$$anonfun$8.apply(Bigspa_df_getdatacode.scala:219)
        at org.apache.spark.rdd.RDD$$anonfun$mapPartitionsWithIndex$1$$anonfun$apply$26.apply(RDD.scala:844)
        at org.apache.spark.rdd.RDD$$anonfun$mapPartitionsWithIndex$1$$anonfun$apply$26.apply(RDD.scala:844)
        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)
        at org.apache.spark.rdd.RDD$$anonfun$8.apply(RDD.scala:336)
        at org.apache.spark.rdd.RDD$$anonfun$8.apply(RDD.scala:334)
        at org.apache.spark.storage.BlockManager$$anonfun$doPutIterator$1.apply(BlockManager.scala:1055)
        at org.apache.spark.storage.BlockManager$$anonfun$doPutIterator$1.apply(BlockManager.scala:1029)
        at org.apache.spark.storage.BlockManager.doPut(BlockManager.scala:969)
        at org.apache.spark.storage.BlockManager.doPutIterator(BlockManager.scala:1029)
        at org.apache.spark.storage.BlockManager.getOrElseUpdate(BlockManager.scala:760)
        at org.apache.spark.rdd.RDD.getOrCompute(RDD.scala:334)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:285)
        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:287)
        at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)
        at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)
        at org.apache.spark.rdd.RDD.iterator(RDD.scala:287)
        at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)
        at org.apache.spark.scheduler.Task.run(Task.scala:108)
        at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:335)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)

old num:                                10043955
coarest num:                            2566590
generate new edges time:                 4.302 sec
pure_newedges:                          1340067
distinct take time:                     7.719 secs
compute take time:                      12.648 secs
update Redis take time:                 0.481 sec
Start UNION
n_edges time take time:                 4.188 sec
End UNION
*step: step 1 take time:         17.349 sec


************During step 2************
old num:                                11384022
coarest num:                            30446339
generate new edges time:                 10.981 sec
pure_newedges:                          1136855
distinct take time:                     1.253 secs
compute take time:                      12.671 secs
update Redis take time:                 0.411 sec
Start UNION
n_edges time take time:                 0.631 sec
End UNION
*step: step 2 take time:         13.723 sec


************During step 3************
old num:                                12520877
coarest num:                            19348256
generate new edges time:                 4.008 sec
pure_newedges:                          794134
distinct take time:                     0.949 secs
compute take time:                      5.378 secs
update Redis take time:                 0.424 sec
Start UNION
n_edges time take time:                 2.123 sec
End UNION
*step: step 3 take time:         7.933 sec


************During step 4************
old num:                                13315011
coarest num:                            17237996
generate new edges time:                 2.773 sec
pure_newedges:                          780502
distinct take time:                     0.970 secs
compute take time:                      4.153 secs
update Redis take time:                 0.508 sec
Start UNION
n_edges time take time:                 0.594 sec
End UNION
*step: step 4 take time:         5.264 sec


************During step 5************
old num:                                14095513
coarest num:                            20553963
generate new edges time:                 3.104 sec
pure_newedges:                          746274
distinct take time:                     1.099 secs
compute take time:                      4.411 secs
update Redis take time:                 0.524 sec
Start UNION
n_edges time take time:                 2.057 sec
End UNION
*step: step 5 take time:         7.000 sec


************During step 6************
old num:                                14841787
coarest num:                            20674028
generate new edges time:                 2.736 sec
pure_newedges:                          758825
distinct take time:                     0.733 secs
compute take time:                      3.728 secs
update Redis take time:                 0.292 sec
Start UNION
n_edges time take time:                 0.591 sec
End UNION
*step: step 6 take time:         4.616 sec


************During step 7************
old num:                                15600612
coarest num:                            23839175
generate new edges time:                 3.164 sec
pure_newedges:                          710160
distinct take time:                     0.723 secs
compute take time:                      4.151 secs
update Redis take time:                 0.345 sec
Start UNION
n_edges time take time:                 0.523 sec
End UNION
*step: step 7 take time:         5.026 sec


************During step 8************
old num:                                16310772
coarest num:                            22553886
generate new edges time:                 2.923 sec
pure_newedges:                          610740
distinct take time:                     0.785 secs
compute take time:                      3.897 secs
update Redis take time:                 0.386 sec
Start UNION
n_edges time take time:                 0.647 sec
End UNION
*step: step 8 take time:         5.032 sec


************During step 9************
old num:                                16921512
coarest num:                            18745159
generate new edges time:                 2.515 sec
pure_newedges:                          503918
distinct take time:                     0.801 secs
compute take time:                      3.573 secs
update Redis take time:                 0.389 sec
Start UNION
n_edges time take time:                 0.529 sec
End UNION
*step: step 9 take time:         4.498 sec


************During step 10************
old num:                                17425430
coarest num:                            14107466
generate new edges time:                 1.905 sec
pure_newedges:                          415509
distinct take time:                     0.803 secs
compute take time:                      2.924 secs
update Redis take time:                 0.434 sec
Start UNION
n_edges time take time:                 1.453 sec
End UNION
*step: step 10 take time:        4.817 sec


************During step 11************
old num:                                17840939
coarest num:                            9262537
generate new edges time:                 1.749 sec
pure_newedges:                          345924
distinct take time:                     0.599 secs
compute take time:                      2.520 secs
update Redis take time:                 0.185 sec
Start UNION
n_edges time take time:                 0.441 sec
End UNION
*step: step 11 take time:        3.150 sec


************During step 12************
old num:                                18186863
coarest num:                            5810809
generate new edges time:                 1.495 sec
pure_newedges:                          285941
distinct take time:                     0.663 secs
compute take time:                      2.365 secs
update Redis take time:                 0.221 sec
Start UNION
n_edges time take time:                 0.482 sec
End UNION
*step: step 12 take time:        3.073 sec


************During step 13************
old num:                                18472804
coarest num:                            3441607
generate new edges time:                 0.597 sec
pure_newedges:                          221520
distinct take time:                     0.697 secs
compute take time:                      1.535 secs
update Redis take time:                 0.278 sec
Start UNION
n_edges time take time:                 0.438 sec
End UNION
*step: step 13 take time:        2.255 sec


************During step 14************
old num:                                18694324
coarest num:                            2355160
generate new edges time:                 0.603 sec
pure_newedges:                          170533
distinct take time:                     0.778 secs
compute take time:                      1.566 secs
update Redis take time:                 0.318 sec
Start UNION
n_edges time take time:                 0.388 sec
End UNION
*step: step 14 take time:        2.277 sec


************During step 15************
old num:                                18864857
coarest num:                            1722529
generate new edges time:                 1.461 sec
pure_newedges:                          136846
distinct take time:                     0.787 secs
compute take time:                      2.541 secs
update Redis take time:                 0.386 sec
Start UNION
n_edges time take time:                 1.371 sec
End UNION
*step: step 15 take time:        4.303 sec


************During step 16************
old num:                                19001703
coarest num:                            1299040
generate new edges time:                 0.476 sec
pure_newedges:                          107562
distinct take time:                     0.439 secs
compute take time:                      1.097 secs
update Redis take time:                 0.107 sec
Start UNION
n_edges time take time:                 0.351 sec
End UNION
*step: step 16 take time:        1.562 sec


************During step 17************
old num:                                19109265
coarest num:                            966720
generate new edges time:                 0.271 sec
pure_newedges:                          75236
distinct take time:                     0.491 secs
compute take time:                      0.997 secs
update Redis take time:                 0.176 sec
Start UNION
n_edges time take time:                 0.339 sec
End UNION
*step: step 17 take time:        1.520 sec


************During step 18************
old num:                                19184501
coarest num:                            647207
generate new edges time:                 0.309 sec
pure_newedges:                          48043
distinct take time:                     0.467 secs
compute take time:                      0.993 secs
update Redis take time:                 0.228 sec
Start UNION
n_edges time take time:                 0.246 sec
End UNION
*step: step 18 take time:        1.472 sec


************During step 19************
old num:                                19232544
coarest num:                            404724
generate new edges time:                 0.389 sec
pure_newedges:                          29042
distinct take time:                     0.569 secs
compute take time:                      1.163 secs
update Redis take time:                 0.264 sec
Start UNION
n_edges time take time:                 0.189 sec
End UNION
*step: step 19 take time:        1.622 sec


************During step 20************
old num:                                19261586
coarest num:                            237877
generate new edges time:                 0.320 sec
pure_newedges:                          16157
distinct take time:                     0.550 secs
compute take time:                      1.069 secs
update Redis take time:                 0.291 sec
Start UNION
n_edges time take time:                 0.976 sec
End UNION
*step: step 20 take time:        2.342 sec


************During step 21************
old num:                                19277743
coarest num:                            128885
generate new edges time:                 2.056 sec
pure_newedges:                          8576
distinct take time:                     0.198 secs
compute take time:                      2.433 secs
update Redis take time:                 0.100 sec
Start UNION
n_edges time take time:                 0.130 sec
End UNION
*step: step 21 take time:        2.666 sec


************During step 22************
old num:                                19286319
coarest num:                            35513802
generate new edges time:                 7.508 sec
pure_newedges:                          12588
distinct take time:                     0.387 secs
compute take time:                      8.159 secs
update Redis take time:                 0.131 sec
Start UNION
n_edges time take time:                 0.156 sec
End UNION
*step: step 22 take time:        8.451 sec


************During step 23************
old num:                                19298907
coarest num:                            98330
generate new edges time:                 0.174 sec
pure_newedges:                          0
distinct take time:                     0.207 secs
compute take time:                      0.571 secs
update Redis take time:                 0.141 sec
Start UNION
n_edges time take time:                 0.121 sec
End UNION
*step: step 23 take time:        0.839 sec

final edges count():                            19298907
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@      Graspan End at 2018-04-18 21:16:52      @@
compute take time 154.333349672 sec
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

Please confirm to end compute!
